<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>VOCATINEST</title>
    <link href="style.css" rel="stylesheet" />
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="img/logo-icon.svg">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link href="style-responsive.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light nav1">
        <div class="container">
            <a class="navbar-brand" href="index.html"><img src="img/logo-navbar.svg" class="img-fluid" alt="Responsive image"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="#">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Kenali Dirimu</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cari-kerja.html">Cari Pekerjaan</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="cari-pelatihan.html">Cari Pelatihan</a>
                    </li>
                    <li class="nav-item cart">
                        <a class="nav-link" href=""><img src="img/nav-shop-cart.svg" alt=""></a>
                    </li>
                </ul>
                <form class="form-inline my-2 my-lg-0">
                    <img class="img-fluid" src="img/nav-img-profile.svg" alt="" id="nav-image">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="nav-name" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Jenri Dewany
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" onclick="logout()">Logout</a>
                            </div>
                        </li>
                    </ul>
                </form>
            </div>
        </div>
    </nav>
    <!-- Navbar -->

    <!-- Main -->
    <div class="container-fluid row-putih pt-0 pb-0">
        <div class="container dashboard mb-5">
            <div class="col-12 text-center">
                <p class="besar">Dashboard Anda</p>
                <p class="abu">Temukan Beragam Pilihan Pekerjaan Vokasi Sesuai Dengan Bakat dan Minatmu</p>
            </div>
            <div class="col-12 top">
                <div class="row mt-4 justify-content-center">
                    <a href="dashboard-profile.html" class="col-3 btn p-4 mr-4 text-left active">
                        <div class="row">
                            <div class="col-12 col-sm-4 col-lg-3 my-auto">
                                <img src="img/dashboard-biru-1-active.svg" alt="">
                            </div>
                            <div class="col-12 col-sm-8 col-lg-9 my-auto">
                                <p class="besar">PROFIL ANDA</p>
                                <p class="kecil"><b>30%</b> Lengkap</p>
                            </div>
                        </div>
                    </a>

                    <a href="dashboard-pekerjaan.html" class="col-3 btn p-4 text-left">
                        <div class="row">
                            <div class="col-12 col-sm-4 col-lg-3 my-auto">
                                <img src="img/dashboard-biru-2.svg" alt="">
                            </div>
                            <div class="col-12 col-sm-8 col-lg-9 my-auto">
                                <p class="besar">PEKERJAAN ANDA</p>
                                <p class="kecil"><b>4</b> pekerjaan yang sesuai</p>
                            </div>
                        </div>
                    </a>

                    <a href="dashboard-pelatihan.html" class="col-3 btn p-4 ml-4 text-left">
                        <div class="row">
                            <div class="col-12 col-sm-4 col-lg-3 my-auto">
                                <img src="img/dashboard-biru-3.svg" alt="">
                            </div>
                            <div class="col-12 col-sm-8 col-lg-9 my-auto">
                                <p class="besar">PELATIHAN ANDA</p>
                                <p class="kecil"><b>2</b> pelatihan yang diikuti</p>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>

        <div class="container edit-atas dashboard mb-5">
            <p class="besar text-center">Info Pekerjaan</p>
            <p class="abu text-center">Isi data dengan benar agar kami dapat mencari pekerjaan yang cocok untuk Anda</p>
            <div class="row">
                <div class="col-12 angka text-center">
                    <button class="btn disabled"><b>1</b></button>
                    <button class="btn active"><b>2</b></button>
                    <button class="btn disabled"><b>3</b></button>
                </div>
            </div>
        </div>

        <div class="container form-profile px-5 py-2 mb-3">
            <p class="judul"><b>Bidang Pekerjaan & Profesi</b></p>
            <form>
                <div class="form-group">
                    <label>Bidang pekerjaan yang diinginkan</label>
                    <select class="form-control" id="job-categories">
                        <option>-- Cari Bidang Pekerjaan --</option>
                    </select>
                    <ul class="nav my-auto detailpelatihan-isi" id="job-categories-selected"></ul>
                </div>

                <div class="form-group">
                    <label>Profesi yang diinginkan</label>
                    <select class="form-control" id="jobs">
                        <option>-- Cari Profesi Anda --</option>
                    </select>
                    <ul class="nav my-auto detailpelatihan-isi" id="job-selected"></ul>
                </div>

                <div class="form-group">
                    <label>Jenis Profesi yang diinginkan</label>
                    <div class="row" id="job-kinds"></div>
                </div>

                <div class="form-group">
                    <label>Jenis Perusahaan yang Dicari</label>
                    <select class="form-control" id="company-categories">
                        <option>Cari Jenis Perusahaan yang Anda Cari</option>
                    </select>
                    <ul class="nav my-auto detailpelatihan-isi" id="company-categories-selected"></ul>
                </div>

                <div class="form-group" id="important">
                    <label>Hal yang penting dalam berkarir</label>
                </div>


            </form>
        </div>
        
        <div class="col-12 text-center my-4">
            <a onclick="submitForm()" class="btn btndefault btnedit justify-content-center px-5">Selanjutnya</a>
        </div>
    </div>
    <!-- Main -->

    <!-- Footer -->
    <footer class="py-3">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <a href="index.html"><img src="img/logo-footer.svg" alt="">
                        <p>Copyrights Â© Vocatinest Team 2020</p>
                    </a>
                </div>
                <div class="col-md-9">
                    <ul class="nav justify-content-end">
                        <li class="nav-item">
                            <a class="nav-link" href="#">Tentang Kami</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Kenali Dirimu</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cari-kerja.html">Cari Pekerjaan</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cari-pelatihan.html">Cari Pelatihan</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Bantuan</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Kontak Kami</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Ketentuan & Kondisi</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer -->
    <script>
        function remove(el){
            $(el).remove();
        }

        function submitForm(){
            let job_categories = []
            let jobs = []
            let company_categories = []
            let job_kinds = []
            let important_careers = []

            $('#job-categories-selected li').map((idx, item) => {
                job_categories.push($(item).attr('data-id'))
            })
            
            $('#job-selected li').map((idx, item) => {
                jobs.push($(item).attr('data-id'))
            })

            $('#company-categories-selected li').map((idx, item) => {
                company_categories.push($(item).attr('data-id'))
            })

            $('[name^=job_kinds]').map(function(idx, elem){
                if($(elem).is(':checked')){
                    job_kinds.push($(elem).val())
                };
            });

            $('[name^=important_careers]').map(function(idx, elem){
                if($(elem).is(':checked')){
                    important_careers.push($(elem).val())
                };
            });

            let data = JSON.parse(localStorage.getItem('data'))
            data = {
                ...data,
                job_categories,
                jobs,
                company_categories,
                job_kinds,
                important_careers
            }
            localStorage.setItem('data', JSON.stringify(data));
            window.location.href = "edit-profil3.html";
        }

        function getJobByCategory(id){
            $.ajax({
                url: 'https://api.vocatinest.com/jobs/category/'+id,
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#jobs').append('<option value="'+data.data[i].id+'">'+data.data[i].name+'</option>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });
        }

        function getProfile(){
            $.ajax({
                url: 'https://api.vocatinest.com/profiles/'+localStorage.getItem('user_id'),
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    $('#nav-name').html(data.data.name);
                    $('#nav-image').attr('src', data.data.image);
                },
                error: (error) => {
                    console.log(error)
                }
            });
        }

        function logout(){
            localStorage.clear();
            window.location.href = "masuk.html";
        }

        $(function(){
            getProfile()
            $('#job-categories').change(function(){
                $('#job-categories-selected').append('<li class="nav-item" onclick="remove(this)" data-id="'+$('#job-categories option:selected').val()+'">\
                            <a class="nav-link">'+$('#job-categories option:selected').html()+'</a>\
                        </li>');
                $('#jobs').html('');
                $('#job-categories-selected li').map((idx, item) => {
                    getJobByCategory($(item).attr('data-id'))    
                })
            });

            $('#jobs').change(function(){
                $('#job-selected').append('<li class="nav-item" onclick="remove(this)" data-id="'+$('#jobs option:selected').val()+'">\
                            <a class="nav-link">'+$('#jobs option:selected').html()+'</a>\
                        </li>');
            });

            $('#company-categories').change(function(){
                $('#company-categories-selected').append('<li class="nav-item" onclick="remove(this)" data-id="'+$('#company-categories option:selected').val()+'">\
                            <a class="nav-link">'+$('#company-categories option:selected').html()+'</a>\
                        </li>');
            });

            $.ajax({
                url: 'https://api.vocatinest.com/company-categories',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#company-categories').append('<option value="'+data.data[i].id+'">'+data.data[i].category+'</option>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });

            $.ajax({
                url: 'https://api.vocatinest.com/job-categories',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#job-categories').append('<option value="'+data.data[i].id+'">'+data.data[i].category+'</option>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });

            $.ajax({
                url: 'https://api.vocatinest.com/job-kinds',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#job-kinds').append('<div class="form-check col-6">\
                            <input type="checkbox" name="job_kinds" value="'+data.data[i].id+'">\
                            <label class="form-check-label" for="defaultCheck1">\
                                '+data.data[i].kind+'\
                            </label>\
                        </div>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });

            $.ajax({
                url: 'https://api.vocatinest.com/jobs',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#jobs').append('<option value="'+data.data[i].id+'">'+data.data[i].name+'</option>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });

            $.ajax({
                url: 'https://api.vocatinest.com/important-careers',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#important').append('<div class="form-check">\
                        <input class="form-check-input" type="checkbox" name="important_careers" value="'+data.data[i].id+'">\
                        <label class="form-check-label" for="defaultCheck6">\
                            '+data.data[i].title+'\
                        </label>\
                    </div>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });

            $.ajax({
                url: 'https://api.vocatinest.com/important-careers',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                method: 'GET',
                success: (data) => {
                    for(let i=0; i<data.data.length; i++){
                        $('#important').append('<div class="form-check">\
                        <input class="form-check-input" type="checkbox" name="important_careers" value="'+data.data[i].id+'">\
                        <label class="form-check-label" for="defaultCheck6">\
                            '+data.data[i].title+'\
                        </label>\
                    </div>');
                    }
                },
                error: (error) => {
                    console.log(error)
                }
            });
            
        });
    </script>
</body>

</html>
